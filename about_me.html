<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Simon Vegelahn - Data Engineer specializing in dbt, Snowflake, and ML systems. Business Informatics student with experience at Siemens AG.">
    <meta name="keywords" content="Data Engineer, Business Informatics, Snowflake, dbt, Python, Machine Learning, Power BI">
    <meta name="author" content="Simon Vegelahn">
    <meta name="robots" content="index, follow">
    <title>Simon Vegelahn - Data Engineer | Business Informatics</title>
    <link rel="icon" type="image/png" href="favicon.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #fff;
            color: #000;
            transition: background 0.3s, color 0.3s;
        }

        body.dark {
            background: #111;
            color: #eee;
        }

        .fast-link {
            color: #0066cc;
            text-decoration: none;
        }

        body.dark .fast-link {
            color: #6ab0ff;
        }

        .fast-link:hover {
            text-decoration: underline;
        }

        .fast-link:focus {
            outline: 2px solid #0066cc;
            outline-offset: 2px;
        }

        body.dark .fast-link:focus {
            outline-color: #6ab0ff;
        }

        *:focus-visible {
            outline: 2px solid #0066cc;
            outline-offset: 2px;
        }

        body.dark *:focus-visible {
            outline-color: #6ab0ff;
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
        }

        .lang-select {
            font-family: Arial, sans-serif;
            font-size: 14px;
            padding: 8px 12px;
            border: 1px solid #000;
            background: #fff;
            color: #000;
            cursor: pointer;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23000' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            padding-right: 28px;
        }

        body.dark .lang-select {
            border-color: #eee;
            background-color: #111;
            color: #eee;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23eee' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
        }

        .menu-container {
            position: relative;
        }

        .menu-toggle {
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            padding: 0;
        }

        .menu-toggle svg {
            width: 20px;
            height: 20px;
            stroke: #000;
            fill: none;
            transition: stroke 0.3s;
        }

        body.dark .menu-toggle svg {
            stroke: #eee;
        }

        .menu-tooltip {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 180px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-8px);
            transition: opacity 0.2s, visibility 0.2s, transform 0.2s;
        }

        .menu-tooltip.visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .menu-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            right: 12px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid #ccc;
        }

        .menu-tooltip::after {
            content: '';
            position: absolute;
            top: -7px;
            right: 13px;
            width: 0;
            height: 0;
            border-left: 7px solid transparent;
            border-right: 7px solid transparent;
            border-bottom: 7px solid #fff;
        }

        body.dark .menu-tooltip {
            background: #222;
            border-color: #444;
        }

        body.dark .menu-tooltip::before {
            border-bottom-color: #444;
        }

        body.dark .menu-tooltip::after {
            border-bottom-color: #222;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            cursor: pointer;
            font-size: 14px;
            color: #000;
            text-decoration: none;
            transition: background 0.2s;
        }

        .menu-item:first-child {
            border-radius: 8px 8px 0 0;
        }

        .menu-item:last-child {
            border-radius: 0 0 8px 8px;
        }

        .menu-item:hover {
            background: #f5f5f5;
        }

        body.dark .menu-item {
            color: #eee;
        }

        body.dark .menu-item:hover {
            background: #333;
        }

        .menu-item svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            fill: none;
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .subtitle {
            font-size: 16px;
            color: #666;
            margin: 0;
        }

        body.dark .subtitle {
            color: #999;
        }

        .nav-border {
            border-bottom: 1px solid #ccc;
        }

        body.dark .nav-border {
            border-color: #444;
        }

        .article-box {
            border: 0.5px solid #ddd;
        }

        body.dark .article-box {
            border-color: #444;
        }

        .text-secondary {
            color: #333;
        }

        body.dark .text-secondary {
            color: #ccc;
        }

        .text-muted {
            color: #666;
        }

        body.dark .text-muted {
            color: #999;
        }

        .border-bottom {
            border-bottom: 1px solid #ddd;
        }

        body.dark .border-bottom {
            border-color: #444;
        }

        .header-border {
            border-bottom: 3px solid #000;
        }

        body.dark .header-border {
            border-color: #eee;
        }

        .footer-border {
            border-top: 3px solid #000;
        }

        body.dark .footer-border {
            border-color: #eee;
        }

        .cert-item {
            display: inline-block;
            background: #f5f5f5;
            padding: 4px 10px;
            margin: 4px 4px 4px 0;
            border-radius: 4px;
            font-size: 13px;
        }

        body.dark .cert-item {
            background: #333;
        }

        .job-details {
            margin: 8px 0 0 0;
            padding-left: 20px;
            list-style-type: disc;
        }

        .job-details li {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 4px;
            padding-left: 4px;
        }

        .job-details li:last-child {
            margin-bottom: 0;
        }

        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }

            body {
                background: #fff !important;
                color: #000 !important;
                font-size: 11px;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                color-adjust: exact;
            }

            body.dark {
                background: #fff !important;
                color: #000 !important;
            }

            .controls, .menu-container, .lang-select {
                display: none !important;
            }

            .fast-link {
                color: #0066cc !important;
            }

            .article-box {
                border-color: #ddd !important;
                break-inside: avoid;
            }

            .text-secondary, body.dark .text-secondary {
                color: #333 !important;
            }

            .text-muted, body.dark .text-muted {
                color: #666 !important;
            }

            .subtitle, body.dark .subtitle {
                color: #666 !important;
            }

            .header-border, body.dark .header-border {
                border-color: #000 !important;
            }

            .footer-border, body.dark .footer-border {
                border-color: #000 !important;
            }

            .nav-border, body.dark .nav-border {
                border-color: #ccc !important;
            }

            .border-bottom, body.dark .border-bottom {
                border-color: #ddd !important;
            }

            .cert-item, body.dark .cert-item {
                background: #f5f5f5 !important;
                color: #000 !important;
            }

            section, article {
                break-inside: avoid;
            }

            h2 {
                break-after: avoid;
            }
        }
    </style>
</head>

<body>
    <div style="max-width: 1200px; margin: 0 auto; padding: 24px;">
        <header class="header-border" style="padding-bottom: 12px; margin-bottom: 20px;">
            <div class="header-row">
                <div>
                    <h1 style="font-size: 32px; font-weight: bold; margin: 0 0 4px 0;">
                        <a href="index.html" style="color: inherit; text-decoration: none;">SIMON VEGELAHN</a>
                    </h1>
                    <p class="subtitle">Data Engineer | Business Informatics</p>
                </div>
                <div class="controls">
                    <select class="lang-select" aria-label="Select language" onchange="if(this.value) window.location.href=this.value">
                        <option value="about_me.html" selected>EN</option>
                        <option value="about_me_de.html">DE</option>
                        <option value="about_me_es.html">ES</option>
                    </select>
                    <div class="menu-container">
                        <button class="menu-toggle" onclick="toggleMenu(event)" aria-label="Open menu">
                            <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="12" cy="5" r="1"></circle>
                                <circle cx="12" cy="19" r="1"></circle>
                            </svg>
                        </button>
                        <div class="menu-tooltip" id="menuTooltip">
                            <div class="menu-item" onclick="toggleTheme()">
                                <svg class="icon-theme" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="5"></circle>
                                    <line x1="12" y1="1" x2="12" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="23"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="1" y1="12" x2="3" y2="12"></line>
                                    <line x1="21" y1="12" x2="23" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                                <span id="themeText">Dark Mode</span>
                            </div>
                            <div class="menu-item" onclick="exportPDF()">
                                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="12" y1="18" x2="12" y2="12"></line>
                                    <line x1="9" y1="15" x2="12" y2="18"></line>
                                    <line x1="15" y1="15" x2="12" y2="18"></line>
                                </svg>
                                <span>Export as PDF</span>
                            </div>
                            <a class="menu-item" href="index.html">
                                <svg viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M19 12H5"></path>
                                    <polyline points="12 19 5 12 12 5"></polyline>
                                </svg>
                                <span>Back to Portfolio</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <nav class="nav-border" style="margin-bottom: 24px; padding: 12px 0;" aria-label="Page navigation">
            <a href="#about" class="fast-link" style="margin-right: 20px; font-weight: bold;">About</a>
            <a href="#experience" class="fast-link" style="margin-right: 20px; font-weight: bold;">Experience</a>
            <a href="#education" class="fast-link" style="margin-right: 20px; font-weight: bold;">Education</a>
            <a href="#certifications" class="fast-link" style="margin-right: 20px; font-weight: bold;">Certifications</a>
            <a href="#projects" class="fast-link" style="margin-right: 20px; font-weight: bold;">Projects</a>
            <a href="#skills" class="fast-link" style="margin-right: 20px; font-weight: bold;">Skills</a>
            <a href="#contact" class="fast-link" style="font-weight: bold;">Contact</a>
        </nav>

        <main id="main-content">
        <article id="about" class="article-box" style="margin-bottom: 20px; padding: 16px;">
            <h2 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">About</h2>
            <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                Data Engineer at Siemens AG building analytics infrastructure, ML systems, and self-service reporting. Originally a state-certified chemical-technical assistant, I transitioned to IT four years ago. Currently completing my Business Informatics degree at Fontys Venlo (Feb 2026). Stack: Snowflake, dbt, Python, Power BI, SQL, Git.
            </p>
            <div class="text-muted" style="font-size: 12px;">Data Analytics • Snowflake • Applied Machine Learning • dbt • Python</div>
        </article>

        <section id="experience" style="margin-bottom: 32px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0;">WORK EXPERIENCE</h2>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Student Employee, Data Governance</strong>
                    <span class="text-muted" style="font-size: 14px;">Siemens AG | Mar 2025 - Present</span>
                </div>
                <ul class="job-details text-secondary">
                    <li>Development of 5 Power BI Dashboards for self-service analytics and management reporting in controlling and specialist departments.</li>
                    <li>Building and maintaining data products for enterprise-wide use; refactoring existing pipelines, adapting to restructuring.</li>
                    <li>Contributing to establishing modular dbt standards across dozens of sources; 60% reduction in computational processing time.</li>
                    <li>Full development of a time series forecasting system for fire protection and security technology (SI B); MAPE &lt;16%.</li>
                    <li>Development of an ML classification system for lead scoring (91%+ accuracy) as part of the COMET initiative.</li>
                    <li>Documentation of existing data products and dashboards to build a knowledge base.</li>
                </ul>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Student Employee, Project Management & Management Tooling</strong>
                    <span class="text-muted" style="font-size: 14px;">Siemens AG | Feb 2022 - Feb 2025</span>
                </div>
                <ul class="job-details text-secondary">
                    <li>Development of VBA tools for management and sales; time savings of approximately 1 to 2 hours per week per project.</li>
                    <li>Building an automated onboarding system with role-based notifications, permission requests, and equipment ordering.</li>
                    <li>Processing of over 110 contract extensions in SAP for sales.</li>
                    <li>Quantity surveying (cable measurement) for a multi-story hospital construction project at Uniklinikum Düsseldorf.</li>
                </ul>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Lab Technician Quality Control</strong>
                    <span class="text-muted" style="font-size: 14px;">Mayr-Melnhof Karton GmbH | Aug 2020 - May 2021</span>
                </div>
                <ul class="job-details text-secondary">
                    <li>Conducted quality control testing and maintained technical documentation in a production environment.</li>
                    <li>Ensured compliance with GLP standards.</li>
                    <li>Initially employed via Jobactive GmbH (Aug 2020 - Mar 2021), transitioned to direct hire.</li>
                </ul>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Logistics Employee</strong>
                    <span class="text-muted" style="font-size: 14px;">flaschenpost SE | Feb 2020 - May 2020</span>
                </div>
                <ul class="job-details text-secondary">
                    <li>Warehouse operations and inventory management.</li>
                </ul>
            </div>

            <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Chemical Laboratory Technician Intern</strong>
                    <span class="text-muted" style="font-size: 14px;">Bergische Universität Wuppertal | Oct 2019 - Dec 2019</span>
                </div>
                <ul class="job-details text-secondary">
                    <li>Performed laboratory techniques including wet chemistry procedures in an academic research setting.</li>
                    <li>Assisted a Ph.D. candidate in a research project.</li>
                </ul>
            </div>
        </section>

        <section id="education" style="margin-bottom: 32px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0;">EDUCATION</h2>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Fontys Venlo University of Applied Sciences</strong>
                    <span class="text-muted" style="font-size: 14px;">2021 - 2026</span>
                </div>
                <p class="text-secondary" style="font-size: 14px; margin: 0; line-height: 1.5;">Bachelor (B.Sc.), Business Informatics (Wirtschaftsinformatik)</p>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Fontys Venlo University of Applied Sciences</strong>
                    <span class="text-muted" style="font-size: 14px;">Sep 2023 - Jan 2024</span>
                </div>
                <p class="text-secondary" style="font-size: 14px; margin: 0; line-height: 1.5;">International Business Management Minor</p>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Heinrich-Hertz-Berufskolleg Düsseldorf</strong>
                    <span class="text-muted" style="font-size: 14px;">2019 - 2020</span>
                </div>
                <p class="text-secondary" style="font-size: 14px; margin: 0; line-height: 1.5;">State-certified Chemical-Technical Assistant (Staatlich geprüfter Chemisch-technischer Assistent)</p>
            </div>

            <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <strong>Marie-Curie Gymnasium Neuss</strong>
                    <span class="text-muted" style="font-size: 14px;">2011 - 2019</span>
                </div>
                <p class="text-secondary" style="font-size: 14px; margin: 0; line-height: 1.5;">Abitur (General Higher Education Entrance Qualification)</p>
            </div>
        </section>

        <section id="certifications" style="margin-bottom: 32px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0;">CERTIFICATIONS</h2>
            <div role="list" aria-label="Certifications">
                <span class="cert-item" role="listitem">GCCEP</span>
                <span class="cert-item" role="listitem">Data Engineering Professional Certificate by Snowflake</span>
                <span class="cert-item" role="listitem">Artificial Intelligence for Cybersecurity</span>
                <span class="cert-item" role="listitem">Advanced Data Engineering with Snowflake</span>
                <span class="cert-item" role="listitem">dbt Fundamentals</span>
            </div>
        </section>

        <section id="projects" style="margin-bottom: 32px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 16px 0;">PROJECTS</h2>

            <article class="article-box" style="margin-bottom: 20px; padding: 16px;">
                <h3 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">Forecasting of Material Data</h3>
                <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                    Implementation of a forecasting model to predict material requirements, optimizing delivery times and reducing costs.
                </p>
                <div class="text-muted" style="font-size: 12px;">Applied Machine Learning • Regression Analysis • Snowflake Notebook • SQL • Python</div>
            </article>

            <article class="article-box" style="margin-bottom: 20px; padding: 16px;">
                <h3 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">Enterprise Data Products</h3>
                <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                    Implementation of data products for analytics purposes in accordance with defined best practices, thereby supporting the reduction of runtimes by up to 79%.
                </p>
                <div class="text-muted" style="font-size: 12px;">SQL • Snowflake • PowerBI • Python</div>
            </article>

            <article class="article-box" style="margin-bottom: 20px; padding: 16px;">
                <h3 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">University Social Platform</h3>
                <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                    Team creation of a prototype for a university social and networking platform. Received with great enthusiasm. Project selected for continued development and handed over to subsequent team with full and detailed documentation.
                </p>
                <div class="text-muted" style="font-size: 12px;">Kotlin • AndroidSDK • Material UI • Cytoscape • REST APIs • Figma</div>
            </article>

            <article class="article-box" style="margin-bottom: 20px; padding: 16px;">
                <h3 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">Web Development Projects</h3>
                <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                    Design and implementation of websites for SMEs. Freelance work.
                </p>
                <div class="text-muted" style="font-size: 12px;">TypeScript • Vue • React • Wordpress • Figma</div>
            </article>

            <article class="article-box" style="margin-bottom: 20px; padding: 16px;">
                <h3 style="font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">AMI Design System</h3>
                <p class="text-secondary" style="font-size: 14px; margin: 0 0 8px 0; line-height: 1.5;">
                    Open source CSS design system focused on accessibility and a welcoming aesthetic. WCAG AA/AAA compliant, zero JavaScript, ~15KB minified. Available on <a href="https://github.com/SimonVegelahn/AMI" class="fast-link" rel="noopener noreferrer">GitHub</a> and <a href="https://www.npmjs.com/package/ami-css" class="fast-link" rel="noopener noreferrer">npm</a>.
                </p>
                <div class="text-muted" style="font-size: 12px;">CSS • WCAG Accessibility • Design Systems • npm</div>
            </article>
        </section>

        <section id="skills" style="margin-bottom: 32px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0;">TECHNICAL SKILLS</h2>
            <table style="width: 100%; border-collapse: collapse;">
                <tr class="border-bottom">
                    <td style="padding: 8px 0; font-weight: bold; width: 30%;">Development</td>
                    <td style="padding: 8px 0;">Python, Java, Kotlin, REST APIs, OAuth2</td>
                </tr>
                <tr class="border-bottom">
                    <td style="padding: 8px 0; font-weight: bold;">Data & ML</td>
                    <td style="padding: 8px 0;">SQL, Snowflake, dbt, R, Python, Data Analytics, Business Intelligence, Applied Machine Learning</td>
                </tr>
                <tr class="border-bottom">
                    <td style="padding: 8px 0; font-weight: bold;">Web</td>
                    <td style="padding: 8px 0;">Vue, React, Cytoscape, Wordpress</td>
                </tr>
                <tr class="border-bottom">
                    <td style="padding: 8px 0; font-weight: bold;">Tools</td>
                    <td style="padding: 8px 0;">Git, Linux, Bash, Excel, Docker, Agile Methodologies, BPMN, VBA, Process Automation</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0; font-weight: bold;">Languages</td>
                    <td style="padding: 8px 0;">German (Native), English (Native/Bilingual)</td>
                </tr>
            </table>
        </section>
        </main>

        <footer id="contact" class="footer-border" style="padding-top: 16px; margin-top: 40px;">
            <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0;">CONTACT</h2>
            <div class="text-secondary" style="font-size: 14px; margin-bottom: 8px;">
                <strong>Location:</strong> Greater Düsseldorf Area, Germany
            </div>
            <div style="font-size: 14px;">
                <strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/simonvegelahn" class="fast-link" rel="noopener noreferrer">linkedin.com/in/simonvegelahn</a>
            </div>
        </footer>
    </div>

    <script>
        let menuTimeout;

        function toggleMenu(event) {
            event.stopPropagation();
            const menu = document.getElementById('menuTooltip');
            menu.classList.toggle('visible');
            clearTimeout(menuTimeout);
        }

        function closeMenu() {
            const menu = document.getElementById('menuTooltip');
            menu.classList.remove('visible');
        }

        function toggleTheme() {
            document.body.classList.toggle('dark');
            const isDark = document.body.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeText();
            closeMenu();
        }

        function updateThemeText() {
            const themeText = document.getElementById('themeText');
            const isDark = document.body.classList.contains('dark');
            themeText.textContent = isDark ? 'Light Mode' : 'Dark Mode';
            
            const themeIcon = document.querySelector('.icon-theme');
            if (isDark) {
                themeIcon.innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
            } else {
                themeIcon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
            }
        }

        function exportPDF() {
            closeMenu();
            window.print();
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const menuContainer = document.querySelector('.menu-container');
            if (!menuContainer.contains(event.target)) {
                closeMenu();
            }
        });

        // Close menu when hovering outside for 2 seconds
        document.addEventListener('mouseover', function(event) {
            const menuContainer = document.querySelector('.menu-container');
            const menu = document.getElementById('menuTooltip');
            
            if (!menuContainer.contains(event.target) && menu.classList.contains('visible')) {
                clearTimeout(menuTimeout);
                menuTimeout = setTimeout(function() {
                    closeMenu();
                }, 2000);
            }
        });

        // Cancel close when hovering back over menu
        document.querySelector('.menu-container').addEventListener('mouseover', function() {
            clearTimeout(menuTimeout);
        });

        // Initialize theme text on load (always light mode by default)
        document.addEventListener('DOMContentLoaded', function() {
            updateThemeText();
        });
    </script>
</body>

</html>